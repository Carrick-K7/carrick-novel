# T-145: Novel 完整重构 - Tailwind + Lucide + carrick-ui

**状态**: ✅ 已完成
**时间**: 2026-02-25
**优先级**: high

⚠️ 工作目录: /root/.openclaw/workspace/projects/carrick-novel/

---

## 背景

Novel 是 Carrick 高频使用的轻小说阅读器，需要统一技术栈：
- 样式：已用 Tailwind CSS ✅
- 图标：内联 SVG + emoji，需统一为 Lucide
- UI 组件：无，需引入 carrick-ui
- 代码结构：Read.vue 1700+ 行需拆分

---

## 目标

1. 统一图标系统 → Lucide Icons
2. 拆分 Read.vue → 独立组件
3. 抽取通用组件 → carrick-ui
4. 使用 carrick-ui 现有组件

---

## 分析

### 当前组件清单

| 文件 | 行数 | 说明 |
|:---|:---:|:---|
| `views/Home.vue` | ~80 | 书架首页 |
| `views/books/BookDetail.vue` | ~150 | 章节目录 |
| `views/read/Read.vue` | **1700+** | 阅读页（含4个内联抽屉） |
| `components/DownloadPanel.vue` | ~400 | 下载抽屉 |

### Read.vue 内联抽屉

1. **目录抽屉** - 章节列表
2. **下载抽屉** - DownloadPanel 组件
3. **自动播放抽屉** - 播放速度控制
4. **字号调节抽屉** - 字号/主题设置

### 可抽取到 carrick-ui 的组件

| 组件 | 说明 | 优先级 |
|:---|:---|:---:|
| `CDrawer` | 通用底部抽屉 | 高 |
| `CProgress` | 已有，可直接用 | - |
| `CButton` | 已有，可直接用 | - |

---

## 执行计划

### Phase 1: 基础设施
- [ ] 安装 lucide-vue-next
- [ ] 配置 Tailwind 主题色（Miku 色系）
- [ ] 安装 @carrick/ui-components

### Phase 2: carrick-ui 抽取
- [ ] 创建 CDrawer 组件（通用底部抽屉）
- [ ] 导出并发布 carrick-ui

### Phase 3: Novel 组件拆分
- [ ] 拆分 Read.vue → 4 个独立抽屉组件
  - [ ] `components/TocDrawer.vue` - 目录
  - [ ] `components/AutoplayDrawer.vue` - 自动播放
  - [ ] `components/FontsizeDrawer.vue` - 字号调节
- [ ] 重构 DownloadPanel.vue 使用 Lucide
- [ ] 重构 BookDetail.vue 使用 Lucide
- [ ] 重构 Home.vue 使用 Lucide

### Phase 4: 整合
- [ ] Read.vue 引用拆分后的组件
- [ ] 使用 carrick-ui 的 CDrawer/CButton
- [ ] 统一 Lucide 图标

### Phase 5: QA & 部署
- [ ] ESLint + TypeScript 检查
- [ ] 构建成功
- [ ] 功能测试（阅读、翻页、抽屉、下载）
- [ ] Git 提交
- [ ] 部署到 /var/www/carrick-novel/

---

## 验收标准

- [ ] 无内联 SVG，全部使用 Lucide Icons
- [ ] Read.vue < 500 行
- [ ] CDrawer 已抽取到 carrick-ui
- [ ] 构建成功
- [ ] 阅读功能正常
- [ ] 已部署

---

## 注意事项

1. **保持功能完整** - 阅读体验不能变差
2. **渐进式重构** - 每个抽屉独立拆分
3. **通用性** - CDrawer 要考虑 Dashboard 等其他项目也能用
4. **PWA 兼容** - 不影响 PWA 功能

---

## 参考

- Dashboard T-143 组件抽取
- carrick-ui 现有组件：CCard, CButton, CProgress, CStatusDot
- 设计风格：iOS Miku 主题 (#39C5BB)
